/*
* Square1 Slider
* Copyright (c) 2016 Thom Hines
* Licensed under MIT.
* @author Thom Hines
* https://github.com/thomhines/square1
* @version 0.5.0
*/
filter_gallery="",function(e){e.fn.square1=function(t){function a(t){if(!(e(p).find(".image_wrapper:not(.image_loaded), .wrap_placeholder:not(.image_loaded)").length<1)){if($img=t.find("img"),$img.attr("data-src")&&$img.attr("src",$img.attr("data-src")).attr("srcset",$img.attr("data-srcset")),clearTimeout(g),$img.prop("currentSrc"))var s=$img.prop("currentSrc");else s=$img.attr("src");if($img.prop("currentSrc"))s=$img.prop("currentSrc");else s=$img.attr("src");t.css("background-image","url("+s+")"),img=new Image,img.onload=function(){e(this).css("display",""),c.settings.lazy_load?do_nothing=1:t.next().hasClass("image_wrapper")?g=setTimeout(function(){a(t.next())},1e3):t.closest(".square1").find(".image_wrapper").length&&(g=setTimeout(function(){a(t.closest(".square1").find(".image_wrapper").first())},1e3)),t.addClass("image_loaded"),t.closest(".square1").find(".image_wrapper:not(.image_loaded)").length<1&&(p.attr("images_loaded","").removeClass("loading"),c.settings.onLoad())},img.src=s,img.complete&&img.onload(),e('.wrap_placeholder[background-image="'+s+'"]',p).css("background-image","url("+s+")")}}function s(){c.square1_interval=1,i(),_(),c.settings.onPlay()}function r(){clearInterval(c.square1_interval),c.square1_interval=null,c.settings.onStop(),show_trace=1}function i(){c.square1_interval&&(clearInterval(c.square1_interval),clearInterval(c.square1_interval),c.square1_interval=setInterval(n,c.settings.slide_duration+c.settings.transition_time))}function n(){e(".current_slide",p).index();var t=e(".current_slide",p).next(".image_wrapper").index();filter_gallery&&(t=e(".current_slide",p).nextAll('.image_wrapper[space*="'+filter_gallery+'"]').index(),t<0&&e(".image_wrapper",p).first().is('.image_wrapper[space*="'+filter_gallery+'"]')&&(t=e(".image_wrapper",p).first().index()),t<0&&(t=e(".image_wrapper",p).first().nextAll('.image_wrapper[space*="'+filter_gallery+'"]').index())),t<0?(v=1,l(0)):l(t)}function o(){e(".current_slide",p).index();var t=e(".current_slide",p).prev(".image_wrapper").index();filter_gallery&&(t=e(".current_slide",p).prevAll('.image_wrapper[space*="'+filter_gallery+'"]').index(),t<0&&e(".image_wrapper",p).last().is('.image_wrapper[space*="'+filter_gallery+'"]')&&(t=e(".image_wrapper",p).last().index()),t<0&&(t=e(".image_wrapper",p).first().prevAll('.image_wrapper[space*="'+filter_gallery+'"]').index())),t<0?(v=1,l(e(".image_wrapper",p).last().index())):l(t)}function l(t){if(!e(".image_wrapper",p).eq(t).hasClass("image_loaded"))return a(e(".image_wrapper",p).eq(t)),void setTimeout(function(){l(t)},100);e(".image_wrapper",p).finish().clearQueue(),"slide"==c.settings.animation?(reset_slide_position=!1,target_slide=t,last_slide=e(".image_wrapper",p).last().index(),clearTimeout(c.reset_position_timeout),e(".image_wrapper, .wrap_placeholder",p).removeClass("no_transition"),v&&0==t?(reset_slide_position="first",target_slide=last_slide+1):v&&t==last_slide&&(e(".wrap_placeholder",p).first().hasClass("image_loaded")||a(e(".wrap_placeholder",p).first()),reset_slide_position="last",target_slide=-1),v=0,e(".current_slide",p).removeClass("current_slide"),e(".image_wrapper",p).eq(t).addClass("current_slide"),translate_target=-100*target_slide,e(".image_wrapper, .wrap_placeholder",p).css("transform","translateX("+translate_target+"%)"),"first"==reset_slide_position&&(c.reset_position_timeout=setTimeout(function(){e(".image_wrapper, .wrap_placeholder",p).addClass("no_transition"),e(".image_wrapper, .wrap_placeholder",p).css("transform","translateX(0%)")},c.settings.transition_time)),"last"==reset_slide_position&&(c.reset_position_timeout=setTimeout(function(){e(".image_wrapper, .wrap_placeholder",p).addClass("no_transition"),e(".image_wrapper, .wrap_placeholder",p).css("transform","translateX(-"+100*last_slide+"%)")},c.settings.transition_time))):"cover"==c.settings.fill_mode?t>e(".current_slide",p).index()?(e(".current_slide",p).removeClass("current_slide"),e(".image_wrapper",p).eq(t).addClass("current_slide").fadeIn(c.settings.transition_time,function(){e(".image_wrapper:not(.current_slide)",p).hide()})):t<e(".current_slide",p).index()&&(e(".current_slide",p).removeClass("current_slide").fadeOut(c.settings.transition_time),e(".image_wrapper",p).eq(t).addClass("current_slide").show()):(e(".current_slide",p).removeClass("current_slide").fadeOut(c.settings.transition_time),e(".image_wrapper",p).eq(t).addClass("current_slide").fadeIn(c.settings.transition_time)),i(),d(),_(),c.settings.onChange()}function d(){"none"!=c.settings.caption?e(".square1_caption",p).fadeOut(c.settings.transition_time,function(){setTimeout(function(){e(".square1_caption",p).html(e(".current_slide img",p).attr("alt")).fadeIn(c.settings.transition_time-200)},10)}):e(".square1_caption",p).remove()}function _(){"none"!=c.settings.dots_nav?(e(".square1_dots span",p).removeClass("current"),e('.square1_dots span[data-image-num="'+e(".current_slide",p).index()+'"]',p).addClass("current")):e(".square1_dots",p).remove()}var p=this,c=e(this)[0];c.reset_position_timeout=null;var g=null;if(!(p.length<1)){if(c.settings||(c.settings=e.extend({width:"",height:"",fill_mode:"cover",scale_from:"center center",background:"none",lazy_load:!1,auto_start:!0,start_delay:0,slide_duration:4e3,transition_time:500,pause_on_hover:!1,keyboard:!0,gestures:!0,theme:"dark",prev_next_nav:"inside",dots_nav:"inside",caption:"outside",onLoad:function(){},onPlay:function(){},onStop:function(){},onChange:function(){}},t)),"play"!=t){if("stop"==t)return c.settings.auto_start=!1,void r();if("next"==t)return n(),void(c.settings.auto_start&&i());if("prev"==t)return o(),void(c.settings.auto_start&&i());if(Math.floor(t)===t&&+t===t)return l(t-1),void(c.settings.auto_start&&i());e(p).css({position:"relative",width:c.settings.width,height:c.settings.height,background:c.settings.background}),p.addClass("square1 loading"),c.settings.keyboard&&!p.attr("tabindex")&&p.attr("tabindex",0),p.wrapInner('<div class="slides_container" />'),p.find(".slides_container").children().wrap('<div class="image_wrapper" />'),e(".image_wrapper",p).each(function(){$img=e(this).find("img"),e(this).attr("scale-from",$img.attr("scale-from")).attr("scale-from-mobile",$img.attr("scale-from-mobile")).attr("space",$img.attr("space"))}),a(e(".image_wrapper:first-child",p)),e(".image_wrapper:first",p).addClass("current_slide"),e(".image_wrapper:not(.current_slide)",p).hide(),e(p).append('<div class="square1_caption"></div>'),e(p).find(".image_wrapper").length>1&&e(p).append('<div class="square1_controls"><span class="square1_prev_image">Previous</span><span class="square1_next_image">Next</span><div class="square1_dots"></div></div>'),e(p).append('<div class="square1_spinner"></div>');var u,m,f,w,h=0;if(e(".image_wrapper",p).each(function(){e(".square1_dots",p).append('<span data-image-num="'+h+'"></span>'),h++}),e(".square1_dots span:first-child",p).addClass("current"),"slide"==c.settings.animation){p.addClass("slide_animation"),e(".image_wrapper, .wrap_placeholder",p).show();h=0;e(".image_wrapper, .wrap_placeholder",p).each(function(){e(this).css({left:100*h+"%",transitionDuration:c.settings.transition_time+"ms"}),h++}),e(".image_wrapper",p).last().clone().removeClass("image_wrapper").addClass("wrap_placeholder").css({left:"-100%"}).appendTo(e(".slides_container",p)),e(".image_wrapper",p).first().clone().removeClass("image_wrapper").addClass("wrap_placeholder").css({left:100*e(".image_wrapper",p).length+"%"}).appendTo(e(".slides_container",p))}if(e(p).addClass("fill_mode-"+c.settings.fill_mode),e(p).addClass("theme-"+c.settings.theme),e(p).addClass("prev_next_nav-"+c.settings.prev_next_nav),e(p).addClass("dots_nav-"+c.settings.dots_nav),e(p).addClass("caption-"+c.settings.caption),e(".square1_prev_image",p).click(function(){o()}),e(".square1_next_image",p).click(function(){n()}),e(".square1_dots span",p).click(function(){l(e(this).data("image-num"))}),e(p).keydown(function(e){if(37==e.keyCode||38==e.keyCode)o();else{if(39!=e.keyCode&&40!=e.keyCode)return;n()}e.preventDefault(),e.stopPropagation()}),c.settings.gestures)e(p).on("touchstart",function(e){u=e.touches[0].screenX,m=e.touches[0].screenY,f=new Date}),e(p).on("touchmove",function(e){w=e}),e(p).on("touchend",function(e){deltaX=w.touches[0].screenX-u,deltaY=w.touches[0].screenY-m,touchDuration=new Date-f,Math.abs(deltaX/deltaY)<2||Math.abs(deltaX)<30||touchDuration>800||(deltaX>0?o():n())});e(p).on("mouseenter",function(){c.settings.pause_on_hover&&r()}),e(p).on("mouseleave",function(){c.settings.pause_on_hover&&c.settings.auto_start&&s()}),c.settings.auto_start&&setTimeout(s,c.settings.start_delay),d(),show_trace=0;var v=0;return p}s()}}}(jQuery);